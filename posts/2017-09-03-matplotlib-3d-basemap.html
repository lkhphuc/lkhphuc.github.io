<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>How to plot a 3D Earth map using Basemap and Matplotlib</title>
  <meta name="description" content="In this tutorial, I will show you how to plot a 3-Dimension Earth Map from satellite data using Basemap and Matplotlib.">

  <!-- Google Fonts loaded here depending on setting in _data/options.yml true loads font, blank does not-->
  
    <link href='//fonts.googleapis.com/css?family=Lato:400,400italic' rel='stylesheet' type='text/css'>
  
  
<!-- Load up MathJax script if needed ... specify in /_data/options.yml file-->
  
    <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: [
      "MathMenu.js",
      "MathZoom.js",
      "AssistiveMML.js",
      "a11y/accessibility-menu.js"
    ],
    jax: ["input/TeX", "output/CommonHTML"],
    TeX: {
      extensions: [
        "AMSmath.js",
        "AMSsymbols.js",
        "noErrors.js",
        "noUndefined.js",
      ]
    }
  });
</script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>  


  <link rel="stylesheet" type="text/css" href="/lkhphuc.github.io/css/tufte.css">
  <!-- <link rel="stylesheet" type="text/css" href="/lkhphuc.github.io/css/print.css" media="print"> -->

  <link rel="canonical" href="/lkhphuc.github.io/posts/2017-09-03-matplotlib-3d-basemap">

  <link rel="alternate" type="application/rss+xml" title="Phúc you" href="/lkhphuc.github.io/feed.xml" />

    <!-- Google Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-191429940-1', 'auto');
	ga('send', 'pageview', { 'page': location.pathname + location.search + location.hash});
	ga('set', 'anonymizeIp', true);
    </script>
    <!-- End Google Analytics -->
    </head>

  <body>
    <!--- Header and nav template site-wide -->
<header>
    <nav class="group">
	<!-- <a href="/lkhphuc.github.io/"><img class="badge" src="/lkhphuc.github.io/assets/img/badge_1.png" alt="CH"></a> -->
	
		
  	
		
		    
		      <a href="/lkhphuc.github.io/">Phúc H. Lê Khắc</a>
		    
	    
  	
		
		    
		      <a href="/lkhphuc.github.io/posts">Posts</a>
		    
	    
  	
		
		    
		      <a href="/lkhphuc.github.io/css/print.css"></a>
		    
	    
  	
		
  	
		
		    
		      <a href="/lkhphuc.github.io/redirects.json"></a>
		    
	    
  	
	</nav>
</header>

    <article class="group">
      <h1>How to plot a 3D Earth map using Basemap and Matplotlib</h1>
<p class="subtitle">September 3, 2017</p>

<p>In this tutorial, I will show you how to plot a 3-Dimension Earth Map from satellite data using Basemap and Matplotlib.</p>

<!--more-->

<p>The result will be something like this with interaction:</p>

<figure><img src="/lkhphuc.github.io/img/matplotlib-3d-basemap/Elec_dens.png" /><figcaption class="maincolumn-figure"></figcaption></figure>

<blockquote>
  <p>All the sample data and code file can be found here: <a href="https://github.com/lkhphuc/Matplotlib-3D-Basemap">https://github.com/lkhphuc/Matplotlib-3D-Basemap</a></p>
</blockquote>

<h2 id="the-data">The data</h2>

<p>We will try to plot the data from a real satellite <a href="http://cdaac-www.cosmic.ucar.edu/cdaac/doc/formats.html"><strong>COSMIC</strong> </a>.
We will plot a scientific information - <em>Electron density</em> or <em>TEC (Total Electron Content)</em> with respect to  <em>longtitude, latitude, altitude</em> in 3D map.</p>

<p><strong>Libraries</strong>:</p>
<ul>
  <li>The data is in <em>nc</em> format and will be read using the <em>netCDF4</em> library.</li>
  <li>To illustrate the position with the <em>lon, lat</em> info, we will use <em>Basemap</em>.</li>
  <li>To plot a 3D figure we use the <em>mplot3d</em> package of <em>matplotlib</em>.</li>
</ul>

<h2 id="import">Import</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="n">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.basemap</span> <span class="kn">import</span> <span class="n">Basemap</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">netCDF4</span> <span class="kn">import</span> <span class="n">Dataset</span>
</code></pre></div></div>

<h2 id="create-a-3d-normal-figure">Create a 3d normal figure</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="p">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s">'3d'</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="draw-the-earth-map-using-basemap">Draw the Earth map using Basemap</h2>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Define lower left, uperright lontitude and lattitude respectively
</span><span class="n">extent</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">180</span><span class="p">,</span> <span class="mi">180</span><span class="p">,</span> <span class="o">-</span><span class="mi">90</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
<span class="c1"># Create a basemap instance that draws the Earth layer
</span><span class="n">bm</span> <span class="o">=</span> <span class="n">Basemap</span><span class="p">(</span><span class="n">llcrnrlon</span><span class="o">=</span><span class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">llcrnrlat</span><span class="o">=</span><span class="n">extent</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
             <span class="n">urcrnrlon</span><span class="o">=</span><span class="n">extent</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">urcrnrlat</span><span class="o">=</span><span class="n">extent</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
             <span class="n">projection</span><span class="o">=</span><span class="s">'cyl'</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="s">'l'</span><span class="p">,</span> <span class="n">fix_aspect</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="c1"># Add Basemap to the figure
</span><span class="n">ax</span><span class="p">.</span><span class="n">add_collection3d</span><span class="p">(</span><span class="n">bm</span><span class="p">.</span><span class="n">drawcoastlines</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.25</span><span class="p">))</span>
<span class="n">ax</span><span class="p">.</span><span class="n">add_collection3d</span><span class="p">(</span><span class="n">bm</span><span class="p">.</span><span class="n">drawcountries</span><span class="p">(</span><span class="n">linewidth</span><span class="o">=</span><span class="mf">0.35</span><span class="p">))</span>
<span class="n">ax</span><span class="p">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">azim</span><span class="o">=</span><span class="mi">230</span><span class="p">,</span> <span class="n">elev</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">'Longitude (°E)'</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">'Latitude (°N)'</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s">'Altitude (km)'</span><span class="p">,</span> <span class="n">labelpad</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1"># Add meridian and parallel gridlines
</span><span class="n">lon_step</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">lat_step</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">meridians</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">extent</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">lon_step</span><span class="p">,</span> <span class="n">lon_step</span><span class="p">)</span>
<span class="n">parallels</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="n">extent</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+</span> <span class="n">lat_step</span><span class="p">,</span> <span class="n">lat_step</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">parallels</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">parallels</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">meridians</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">meridians</span><span class="p">)</span>
<span class="n">ax</span><span class="p">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1000.</span><span class="p">)</span>
</code></pre></div></div>

<p>At this point you can add <code class="language-plaintext highlighter-rouge">plt.show()</code> and see a nice Basemap in an interactive 3D projection.</p>

<figure><img src="/lkhphuc.github.io/img/matplotlib-3d-basemap/basemap-3d.png" /><figcaption class="maincolumn-figure">A basemap.)</figcaption></figure>



    </article>
    <span class="print-footer">How to plot a 3D Earth map using Basemap and Matplotlib - September 3, 2017 - Phúc H. Lê Khắc</span>
    <footer>
  <hr class="slender">
  <ul class="footer-links">
    <li><a href="mailto:phuc@lkhphuc.com"><span class="icon-mail3"></span></a></li>    
    
      <li>
        <a href="//www.twitter.com/lkhphuc"><span class="icon-twitter"></span></a>
      </li>
    
      <li>
        <a href="//github.com/lkhphuc"><span class="icon-github"></span></a>
      </li>
    
      <li>
        <a href="//www.linkedin.com/in/lkhphuc"><span class="icon-linkedin"></span></a>
      </li>
      
  </ul>
<div class="credits">
<span>&copy; 2024 &nbsp;&nbsp;PHÚC H. LÊ KHẮC</span></br> <br>
<span>This site created with the <a href="//github.com/clayh53/tufte-jekyll">Tufte theme for  </a> in <a href="//jekyllrb.com">Jekyll</a>.</span> 
</div>  
</footer>

  </body>
</html>
